
<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skyline - 7 Day Weather</title>
  <style>
    :root{
      --bg: linear-gradient(180deg,#e6f0ff,#f7fcff);
      --card: #ffffff;
      --accent: #1e88e5;
      --muted: #6b7280;
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
    }
    body{
      margin:0;
      min-height:100vh;
      background:var(--bg);
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:20px;
      padding:28px;
      color:#0f172a;
    }
    header{
      width:100%;
      max-width:1000px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
    }
    h1{ margin:0; font-size:1.25rem; letter-spacing:0.2px;}
    .search{
      display:flex;
      gap:8px;
      align-items:center;
    }
    input[type="text"]{
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(15,23,42,0.08);
      width:240px;
      outline:none;
      box-shadow: 0 1px 0 rgba(2,6,23,0.02);
    }
    button{
      padding:10px 14px;
      border-radius:10px;
      border:none;
      background:var(--accent);
      color:white;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(30,136,229,0.12);
    }
    .container{
      width:100%;
      max-width:1000px;
      background:transparent;
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    .summary{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px;
      border-radius:12px;
      background:rgba(255,255,255,0.6);
      backdrop-filter: blur(6px);
      box-shadow: 0 4px 18px rgba(2,6,23,0.03);
    }
    .city { font-weight:600; }
    .cards{
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(140px,1fr));
      gap:12px;
    }
    .card{
      background:var(--card);
      border-radius:12px;
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
      text-align:center;
      box-shadow: 0 6px 20px rgba(2,6,23,0.04);
    }
    .date { font-weight:600; font-size:0.95rem;}
    .temp { font-size:1.6rem; margin-top:4px;}
    .desc { text-transform:capitalize; color:var(--muted); font-size:0.9rem;}
    .meta { font-size:0.85rem; color:var(--muted); display:flex; gap:10px; margin-top:6px; flex-wrap:wrap; justify-content:center;}
    .small { font-size:0.78rem; color:#475569; }
    .loading { text-align:center; padding:20px; color:var(--muted); }
    @media (max-width:520px){
      header{ flex-direction:column; align-items:flex-start; gap:8px; }
      input[type="text"]{ width:100%; }
    }
  </style>
</head>
<body>
  <header>
    <div>
      <h1>Skyline â€” 7 Day Weather</h1>
      <div class="small">Enter city name or allow location</div>
    </div>
    <div class="search">
      <input id="cityInput" type="text" placeholder="e.g. Chennai, India" />
      <button id="searchBtn">Search</button>
      <button id="locBtn" title="Use your browser location">Use My Location</button>
	  <a href="chellenge.html">
	  <button id="next">Next</button>
    </div>
  </header>

  <main class="container">
    <div id="status" class="summary">
      <div>
        <div class="city" id="cityName">--</div>
        <div class="small" id="coords">lat: -- lon: --</div>
      </div>
      <div class="small" id="updateTime">Updated: --</div>
    </div>

    <div id="content">
      <div class="loading" id="loading">Search a city or use your location to see 7-day forecast.</div>
      <div class="cards" id="cards" style="display:none;"></div>
    </div>
  </main>

  <script>
    // ---------- CONFIG ----------
    const API_KEY = "YOUR_OPENWEATHER_API_KEY"; // <-- change this
    // ----------------------------

    const searchBtn = document.getElementById("searchBtn");
    const locBtn = document.getElementById("locBtn");
    const cityInput = document.getElementById("cityInput");
    const loadingEl = document.getElementById("loading");
    const cardsEl = document.getElementById("cards");
    const cityNameEl = document.getElementById("cityName");
    const coordsEl = document.getElementById("coords");
    const updateTimeEl = document.getElementById("updateTime");

    searchBtn.addEventListener("click", () => {
      const q = cityInput.value.trim();
      if(!q){ alert("City name à®µà®šà¯à®šà¯ search à®ªà®£à¯à®£à¯à®™à¯à®•."); return; }
      fetchByCity(q);
    });

    locBtn.addEventListener("click", () => {
      if(navigator.geolocation){
        loading("Getting your location...");
        navigator.geolocation.getCurrentPosition(pos => {
          const {latitude, longitude} = pos.coords;
          fetchByCoords(latitude, longitude, "Your location");
        }, err => {
          alert("Location permission denied or unavailable.");
          clearLoading();
        });
      } else {
        alert("Geolocation not supported by browser.");
      }
    });

    // helper to show loading text
    function loading(text="Loading..."){
      loadingEl.style.display = "block";
      cardsEl.style.display = "none";
      loadingEl.textContent = text;
    }
    function clearLoading(){
      loadingEl.style.display = "none";
    }

    async function fetchByCity(city){
      try{
        loading("Searching city...");
        // Geocoding
        const geoUrl = `https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=1&appid=${API_KEY}`;
        const gres = await fetch(geoUrl);
        if(!gres.ok) throw new Error("Geocoding failed");
        const gdata = await gres.json();
        if(!gdata || gdata.length===0) throw new Error("City not found");
        const {lat, lon, name, country, state} = gdata[0];
        const display = [name, state, country].filter(Boolean).join(", ");
        fetchByCoords(lat, lon, display);
      } catch(err){
        console.error(err);
        alert("City search error: " + err.message);
        clearLoading();
        loadingEl.textContent = "City search failed. Check console.";
      }
    }

    async function fetchByCoords(lat, lon, placeName = ""){
      try{
        if(!API_KEY || API_KEY === "YOUR_OPENWEATHER_API_KEY"){
          // show sample fallback if API key not set
          loading("No API key set â€” showing sample demo data.");
          showSample();
          return;
        }

        loading("Fetching weather...");
        const onecall = `https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&exclude=minutely,hourly,alerts&units=metric&appid=${API_KEY}`;
        const res = await fetch(onecall);
        if(!res.ok) throw new Error("Weather fetch failed");
        const data = await res.json();
        renderForecast(data, lat, lon, placeName);
      } catch(err){
        console.error(err);
        alert("Weather fetch error: " + err.message);
        // try sample fallback
        showSample();
      }
    }

    function renderForecast(data, lat, lon, placeName){
      clearLoading();
      const timezone = data.timezone || "Local";
      cityNameEl.textContent = placeName || timezone;
      coordsEl.textContent = `lat: ${Number(lat).toFixed(3)} lon: ${Number(lon).toFixed(3)}`;
      updateTimeEl.textContent = `Updated: ${new Date().toLocaleString()}`;
      cardsEl.innerHTML = "";
      cardsEl.style.display = "grid";

      // daily array includes today + 7 days (usually up to 8). Keep first 7.
      const days = (data.daily || []).slice(0,7);
      if(days.length === 0){
        loadingEl.textContent = "No daily data available.";
        return;
      }

      days.forEach(d => {
        const date = new Date(d.dt * 1000);
        const dayName = new Intl.DateTimeFormat(undefined,{weekday:'short', month:'short', day:'numeric'}).format(date);
        const icon = d.weather && d.weather[0] ? d.weather[0].icon : "01d";
        const desc = d.weather && d.weather[0] ? d.weather[0].description : "â€”";
        const max = Math.round(d.temp.max);
        const min = Math.round(d.temp.min);
        const hum = d.humidity;
        const wind = d.wind_speed;
        const pop = (d.pop !== undefined) ? Math.round(d.pop * 100) : null;

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <div class="date">${dayName}</div>
          <img src="https://openweathermap.org/img/wn/${icon}@2x.png" alt="${desc}" width="80" height="80" />
          <div class="temp">${max}Â° / <span style="opacity:0.8">${min}Â°</span></div>
          <div class="desc">${desc}</div>
          <div class="meta">
            <div>ðŸ’§ ${hum}%</div>
            <div>ðŸŒ¬ ${wind} m/s</div>
            ${pop !== null ? `<div>â˜” ${pop}%</div>` : ''}
          </div>
        `;
        cardsEl.appendChild(card);
      });
    }

    function showSample(){
      // Minimal sample data for demo when API not available
      const sample = {
        timezone: "Sample/City",
        daily: [
          {"dt": 1698796800, "temp":{"max":32,"min":26}, "weather":[{"icon":"01d","description":"clear sky"}],"humidity":62,"wind_speed":3.2,"pop":0.05},
          {"dt": 1698883200, "temp":{"max":31,"min":25}, "weather":[{"icon":"02d","description":"few clouds"}],"humidity":64,"wind_speed":3.6,"pop":0.10},
          {"dt": 1698969600, "temp":{"max":30,"min":25}, "weather":[{"icon":"10d","description":"light rain"}],"humidity":72,"wind_speed":4.1,"pop":0.55},
          {"dt": 1699056000, "temp":{"max":29,"min":24}, "weather":[{"icon":"04d","description":"broken clouds"}],"humidity":68,"wind_speed":3.9,"pop":0.20},
          {"dt": 1699142400, "temp":{"max":31,"min":25}, "weather":[{"icon":"01d","description":"clear sky"}],"humidity":60,"wind_speed":3.0,"pop":0.02},
          {"dt": 1699228800, "temp":{"max":33,"min":26}, "weather":[{"icon":"01d","description":"clear sky"}],"humidity":59,"wind_speed":2.8,"pop":0},
          {"dt": 1699315200, "temp":{"max":32,"min":26}, "weather":[{"icon":"03d","description":"scattered clouds"}],"humidity":61,"wind_speed":3.1,"pop":0.03}
        ]
      };
      renderForecast(sample, 0, 0, "Demo City");
    }

    // Optional: auto show sample to preview
    // showSample();

    // allow pressing Enter to search
    cityInput.addEventListener("keydown", (e) => {
      if(e.key === "Enter") searchBtn.click();
    });

  </script>
</body>
</html>